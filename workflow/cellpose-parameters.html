
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Understanding and adjusting parameters &#8212; napari Segmentation learning course</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Segmenting in napari, and exporting a mask in FIJI" href="cellpose-FIJI.html" />
    <link rel="prev" title="Cellpose-napari + FIJI" href="cellpose.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/Napari teacher.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">napari Segmentation learning course</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    napari Cell Segmentation Course
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Preface
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../preface/landing.html">
   Background to segmentation course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../preface/imageanalysis.html">
   Primer to image analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../preface/feedback.html">
   Feedback and contributing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Onboarding to napari
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../onboard/whatisnapari.html">
   What is napari?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../onboard/lesson2.html">
   Getting started with napari
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Segmentation workflows
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="cellpose.html">
   Cellpose-napari + FIJI
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Understanding and adjusting parameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cellpose-FIJI.html">
     Segmenting in napari, and exporting a mask in FIJI
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="partseg.html">
   Classical segmentation with PartSeg
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="partseg-primer.html">
     Theory of image analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="partseg-nuclei.html">
     Segmentation of nuclei
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="partseg-foci.html">
     Segmentation of foci
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="partseg-quantification.html">
     Quantification of segmented regions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="allencell.html">
   Allen Cell Segmenter
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/chanzuckerberg/napari-segmentation-workshop"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/chanzuckerberg/napari-segmentation-workshop/issues/new?title=Issue%20on%20page%20%2Fworkflow/cellpose-parameters.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/workflow/cellpose-parameters.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#opening-the-cellpose-napari-plugin">
   Opening the
   <em>
    Cellpose-napari
   </em>
   plugin
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cellpose-parameters">
   Cellpose parameters
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#image-layer">
     Image layer:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-type-pretrained-model">
     Model type, pretrained model:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#channel-to-segment">
     Channel to segment:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#segmentation-of-rgb-images">
     Segmentation of RGB images:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#segmentation-of-multi-channel-image">
     Segmentation of multi-channel image:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optional-nuclear-channel">
     Optional nuclear channel:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cell-probability-threshold-number-of-masks">
     Cell probability threshold (number of masks):
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-match-threshold-mask-quality-threshold">
     Model match threshold (Mask quality threshold):
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#average-4-nets">
     Average 4 nets:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resample-dynamics">
     Resample dynamics:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#process-stack-as-3d">
     Process stack as 3D:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#clear-previous-results">
     Clear previous results:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#output-flows-and-cellprob">
     Output flows and cellprob:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#output-outlines">
     Output outlines:
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Understanding and adjusting parameters</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#opening-the-cellpose-napari-plugin">
   Opening the
   <em>
    Cellpose-napari
   </em>
   plugin
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cellpose-parameters">
   Cellpose parameters
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#image-layer">
     Image layer:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-type-pretrained-model">
     Model type, pretrained model:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#channel-to-segment">
     Channel to segment:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#segmentation-of-rgb-images">
     Segmentation of RGB images:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#segmentation-of-multi-channel-image">
     Segmentation of multi-channel image:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#optional-nuclear-channel">
     Optional nuclear channel:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cell-probability-threshold-number-of-masks">
     Cell probability threshold (number of masks):
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-match-threshold-mask-quality-threshold">
     Model match threshold (Mask quality threshold):
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#average-4-nets">
     Average 4 nets:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resample-dynamics">
     Resample dynamics:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#process-stack-as-3d">
     Process stack as 3D:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#clear-previous-results">
     Clear previous results:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#output-flows-and-cellprob">
     Output flows and cellprob:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#output-outlines">
     Output outlines:
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="understanding-and-adjusting-parameters">
<h1>Understanding and adjusting parameters<a class="headerlink" href="#understanding-and-adjusting-parameters" title="Permalink to this headline">#</a></h1>
<section id="opening-the-cellpose-napari-plugin">
<h2>Opening the <em>Cellpose-napari</em> plugin<a class="headerlink" href="#opening-the-cellpose-napari-plugin" title="Permalink to this headline">#</a></h2>
<p><img alt="Opening cellpose in the napari menu" src="../_images/cellpose1.png" /></p>
<p>After you’ve launched the napari viewer, you may open the <em>Cellpose-napari</em> plugin by clicking on the <strong>Plugins</strong> menu on the right side of your screen, then checking the plugin in the list that appears.</p>
<p><img alt="Opening cellpose in the napari menu" src="../_images/cellpose2.png" /></p>
</section>
<section id="cellpose-parameters">
<h2>Cellpose parameters<a class="headerlink" href="#cellpose-parameters" title="Permalink to this headline">#</a></h2>
<section id="image-layer">
<h3>Image layer:<a class="headerlink" href="#image-layer" title="Permalink to this headline">#</a></h3>
<p>Define the layer / image that will be segmented using cellpose.</p>
</section>
<section id="model-type-pretrained-model">
<h3>Model type, pretrained model:<a class="headerlink" href="#model-type-pretrained-model" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>the <strong>“cyto”</strong> model (“Cytoplasm”), to segment cells stained for their cytoplasm.</p></li>
<li><p>the <strong>“nuclei”</strong> model (“Nuclei”) to segment cell nuclei.</p></li>
<li><p>the <strong>“cyto2”</strong> model (“Cytoplasm 2.0”), which is the cyto model augmented with user-submitted images.</p></li>
<li><p>the <strong>“Custom”</strong> model, which let you specify a custom model you would have trained or downloaded. You may select this under: <strong>“custom model path”</strong> &gt; <strong>“select file”</strong></p></li>
</ul>
</section>
<section id="channel-to-segment">
<h3>Channel to segment:<a class="headerlink" href="#channel-to-segment" title="Permalink to this headline">#</a></h3>
<p>The channel that will be segmented. If the channel contains cytoplasmic structures, it should be associated with the <strong>“cyto”</strong> and <strong>“cyto2”</strong> pretrained models, or nuclei with the <strong>“nuclei”</strong> model.</p>
</section>
<section id="segmentation-of-rgb-images">
<h3>Segmentation of RGB images:<a class="headerlink" href="#segmentation-of-rgb-images" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>‘0’ means that cellpose will run on a grayscale combination of all channels.</p></li>
<li><p>‘1’ stands for the first channel, corresponding to the red channel in a RGB image.</p></li>
<li><p>Similarly, for ‘2’ and ‘3’, the second and third channel, corresponding to the green and blue channels in a RGB image.</p></li>
</ul>
</section>
<section id="segmentation-of-multi-channel-image">
<h3>Segmentation of multi-channel image:<a class="headerlink" href="#segmentation-of-multi-channel-image" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Ignore the ‘red’, ‘green’, blue’ labels and rely on channel order (found under the image, near the slider).</p></li>
</ul>
<p>OR</p>
<ul class="simple">
<li><p>Isolate the channel of interest: <strong>“right click”</strong> on the layer &gt; <strong>“Split Stack”</strong></p></li>
<li><p>Select it on the <strong>“Image layer option”</strong>, channel to segment: “0”</p></li>
</ul>
</section>
<section id="optional-nuclear-channel">
<h3>Optional nuclear channel:<a class="headerlink" href="#optional-nuclear-channel" title="Permalink to this headline">#</a></h3>
<p>The cytoplasm model in cellpose is trained on two-channel images, where the first channel is the channel to segment, and the second channel is an optional nuclear channel. Here are the options for each: 1. 0=grayscale, 1=red, 2=green, 3=blue, 4 … 2. 0=None (will set to zero), 1=red, 2=green, 3=blue, 4.</p>
<p>The nuclear model in cellpose is trained on two-channel images, where the first channel is the channel to segment, and the second channel is always set to an array of zeros. Therefore, set the first channel as 0=grayscale, 1=red, 2=green, 3=blue; and set the second channel to 0=None
* Diameter (in pixel):</p>
<p>The cellpose models have been trained on images which were rescaled to all have the same diameter (30 pixels in the case of the cyto model and 17 pixels in the case of the nuclei model). Therefore, cellpose needs a user-defined cell diameter (in pixels) as input, or to estimate the object size of an image-by-image basis. If 0 cellpose will estimate for each image, default is 30.</p>
<ul class="simple">
<li><p>Click <strong>“compute diameter from image”</strong> to start diameter estimation. However, if this estimate is incorrect, please set the diameter by hand.</p></li>
</ul>
<p>OR</p>
<ul class="simple">
<li><p>You can also get an estimate from clicking on the image: create a napari ‘Shapes’ layer and draw circles or squares. If you click <strong>“compute diameter from shape layer”</strong>, the plugin will set the diameter to the average diameter of the drawn shapes.</p></li>
</ul>
<p>Changing the diameter will change the results that the algorithm outputs. When the diameter is set smaller than the true size, cellpose may over-split cells. Similarly, if the diameter is set too big then cellpose may over-merge cells.</p>
</section>
<section id="cell-probability-threshold-number-of-masks">
<h3>Cell probability threshold (number of masks):<a class="headerlink" href="#cell-probability-threshold-number-of-masks" title="Permalink to this headline">#</a></h3>
<p>Threshold to determine masks. Decrease this threshold if cellpose is not returning as many masks as you’d expect. Similarly, increase this threshold if cellpose is returning too masks particularly from dim areas.</p>
</section>
<section id="model-match-threshold-mask-quality-threshold">
<h3>Model match threshold (Mask quality threshold):<a class="headerlink" href="#model-match-threshold-mask-quality-threshold" title="Permalink to this headline">#</a></h3>
<p>To check that the recovered shapes after the flow dynamics step are consistent with real masks, we recompute the flow gradients for these putative predicted masks, and compute the mean squared error between them and the flows predicted by the network.</p>
<p>The model match threshold parameter is inverse of the maximum allowed error of the flows for each mask. Decrease this threshold if cellpose is not returning as many masks as you’d expect. Similarly, increase this threshold if cellpose is returning too many ill-shaped masks.</p>
</section>
<section id="average-4-nets">
<h3>Average 4 nets:<a class="headerlink" href="#average-4-nets" title="Permalink to this headline">#</a></h3>
<p>Option to control network performance vs time. If unchecked, only 1 network will use to process the channel allowing a faster segmentation but less accurate. If checked  an average of 4 network will be used, it will be slower but more accurate</p>
</section>
<section id="resample-dynamics">
<h3>Resample dynamics:<a class="headerlink" href="#resample-dynamics" title="Permalink to this headline">#</a></h3>
<p>If not checked, the processing will be done on a diameter = 30 pixels. If checked, the processing will be done based on the original image. Masks will be smoother.</p>
</section>
<section id="process-stack-as-3d">
<h3>Process stack as 3D:<a class="headerlink" href="#process-stack-as-3d" title="Permalink to this headline">#</a></h3>
<p>Cellpose can segment 3D and 4D stacks. If there is a channel axis, specify it by labelling it with ‘c’.</p>
<p>To run 3D processing, check <strong>“process stack as 3D”</strong>.</p>
<p>If the 3D segmentation is not working well and there is inhomogeneity in Z, try <strong>stitching masks</strong> using the <strong>“stitch threshold slices”</strong> option instead of checking process stack as 3D. In this setting, cellpose will create masks in 2D on each XY slice and then stitch them across slices if the IoU between the mask on the current slice and the next slice is greater than or equal to the stitch threshold slices.</p>
</section>
<section id="clear-previous-results">
<h3>Clear previous results:<a class="headerlink" href="#clear-previous-results" title="Permalink to this headline">#</a></h3>
<p>If checked, this removes all previous data.</p>
</section>
<section id="output-flows-and-cellprob">
<h3>Output flows and cellprob:<a class="headerlink" href="#output-flows-and-cellprob" title="Permalink to this headline">#</a></h3>
<p>Show a layer containing the gradient vector field (combination of the predicted horizontal and vertical gradients, as well as whether a pixel belongs to any cell).</p>
</section>
<section id="output-outlines">
<h3>Output outlines:<a class="headerlink" href="#output-outlines" title="Permalink to this headline">#</a></h3>
<p>Show a layer containing cell boundaries.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./workflow"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="cellpose.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">
Cellpose-napari + FIJI</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="cellpose-FIJI.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Segmenting in napari, and exporting a mask in FIJI</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By CZI Imaging Team<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>